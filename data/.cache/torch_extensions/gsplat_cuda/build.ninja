ninja_required_version = 1.3
cxx = c++
nvcc = /usr/local/cuda/bin/nvcc

cflags = -DTORCH_EXTENSION_NAME=gsplat_cuda -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/usr/local/lib/python3.10/dist-packages/gsplat/cuda/include -I/usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/third_party/glm -isystem /usr/local/lib/python3.10/dist-packages/torch/include -isystem /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -isystem /usr/local/lib/python3.10/dist-packages/torch/include/TH -isystem /usr/local/lib/python3.10/dist-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /usr/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -O3 -Wno-attributes
post_cflags = 
cuda_cflags = -DTORCH_EXTENSION_NAME=gsplat_cuda -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/usr/local/lib/python3.10/dist-packages/gsplat/cuda/include -I/usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/third_party/glm -isystem /usr/local/lib/python3.10/dist-packages/torch/include -isystem /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -isystem /usr/local/lib/python3.10/dist-packages/torch/include/TH -isystem /usr/local/lib/python3.10/dist-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /usr/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_86,code=compute_86 -gencode=arch=compute_86,code=sm_86 --compiler-options '-fPIC' -O3 -use_fast_math -std=c++17
cuda_post_cflags = 
cuda_dlink_post_cflags = 
ldflags = -shared -L/usr/local/lib/python3.10/dist-packages/torch/lib -lc10 -lc10_cuda -ltorch_cpu -ltorch_cuda -ltorch -ltorch_python -L/usr/local/cuda/lib64 -lcudart

rule compile
  command = $cxx -MMD -MF $out.d $cflags -c $in -o $out $post_cflags
  depfile = $out.d
  deps = gcc

rule cuda_compile
  depfile = $out.d
  deps = gcc
  command = $nvcc  $cuda_cflags -c $in -o $out $cuda_post_cflags



rule link
  command = $cxx $in $ldflags -o $out

build NullCUDA.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/NullCUDA.cu
build QuatScaleToCovarCUDA.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/QuatScaleToCovarCUDA.cu
build Projection2DGSPacked.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/Projection2DGSPacked.cu
build ProjectionEWA3DGSFused.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/ProjectionEWA3DGSFused.cu
build RasterizeToPixelsFromWorld3DGSBwd.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/RasterizeToPixelsFromWorld3DGSBwd.cu
build RasterizeToIndices3DGS.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/RasterizeToIndices3DGS.cu
build RasterizeToPixels2DGSFwd.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/RasterizeToPixels2DGSFwd.cu
build ProjectionEWASimple.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/ProjectionEWASimple.cu
build RasterizeToPixels3DGSBwd.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/RasterizeToPixels3DGSBwd.cu
build RasterizeToPixelsFromWorld3DGSFwd.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/RasterizeToPixelsFromWorld3DGSFwd.cu
build RasterizeToPixels2DGSBwd.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/RasterizeToPixels2DGSBwd.cu
build RasterizeToPixels3DGSFwd.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/RasterizeToPixels3DGSFwd.cu
build IntersectTile.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/IntersectTile.cu
build RelocationCUDA.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/RelocationCUDA.cu
build ProjectionUT3DGSFused.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/ProjectionUT3DGSFused.cu
build SphericalHarmonicsCUDA.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/SphericalHarmonicsCUDA.cu
build ProjectionEWA3DGSPacked.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/ProjectionEWA3DGSPacked.cu
build AdamCUDA.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/AdamCUDA.cu
build Projection2DGSFused.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/Projection2DGSFused.cu
build RasterizeToIndices2DGS.cuda.o: cuda_compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/RasterizeToIndices2DGS.cu
build Projection.o: compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/Projection.cpp
build Adam.o: compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/Adam.cpp
build Rasterization.o: compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/Rasterization.cpp
build Intersect.o: compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/Intersect.cpp
build Null.o: compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/Null.cpp
build QuatScaleToCovar.o: compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/QuatScaleToCovar.cpp
build Relocation.o: compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/Relocation.cpp
build SphericalHarmonics.o: compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/csrc/SphericalHarmonics.cpp
build ext.o: compile /usr/local/lib/python3.10/dist-packages/gsplat/cuda/ext.cpp



build gsplat_cuda.so: link NullCUDA.cuda.o QuatScaleToCovarCUDA.cuda.o Projection2DGSPacked.cuda.o ProjectionEWA3DGSFused.cuda.o RasterizeToPixelsFromWorld3DGSBwd.cuda.o RasterizeToIndices3DGS.cuda.o RasterizeToPixels2DGSFwd.cuda.o ProjectionEWASimple.cuda.o RasterizeToPixels3DGSBwd.cuda.o RasterizeToPixelsFromWorld3DGSFwd.cuda.o RasterizeToPixels2DGSBwd.cuda.o RasterizeToPixels3DGSFwd.cuda.o IntersectTile.cuda.o RelocationCUDA.cuda.o ProjectionUT3DGSFused.cuda.o SphericalHarmonicsCUDA.cuda.o ProjectionEWA3DGSPacked.cuda.o AdamCUDA.cuda.o Projection2DGSFused.cuda.o RasterizeToIndices2DGS.cuda.o Projection.o Adam.o Rasterization.o Intersect.o Null.o QuatScaleToCovar.o Relocation.o SphericalHarmonics.o ext.o

default gsplat_cuda.so
